<!DOCTYPE html>
<html class="reftest-wait">
<head>
<script src="utils.js">
</script>
</head>
<body style="margin:0" onLoad="forceLoadPlugin('plugin', true)">
<object type="application/x-test" id="plugin"
        drawmode="solid" color="00000000"
        style="width:200px; height:200px; display:block; margin:90px 80px;
               outline:5px dashed blue;
               background:cyan;
               border:dotted black; border-width:4px 8px 4px 8px;
               padding:3px 1px;">
</object>
<script>
var prevPaintCount = 0;
function doTestWait() {
   if (document.getElementById("plugin").getPaintCount() != prevPaintCount) {
      document.documentElement.removeAttribute('class');
   } else {
     setTimeout(doTestWait, 0);
   }
}

function doTest() {
  prevPaintCount = document.getElementById("plugin").getPaintCount();
  document.getElementById("plugin").setColor("FFFF80FF");
  setTimeout(doTestWait, 0);

}
window.addEventListener("MozReftestInvalidate", doTest, false);
</script>
</body>
</html>
