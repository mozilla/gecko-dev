# This Source Code Form is subject to the terms of the Mozilla Public
# License, v. 2.0. If a copy of the MPL was not distributed with this
# file, You can obtain one at http://mozilla.org/MPL/2.0/.

# Adding a new metric? We have docs for that!
# https://firefox-source-docs.mozilla.org/toolkit/components/glean/user/new_definitions_file.html

---
$schema: moz://mozilla.org/schemas/glean/metrics/2-0-0
$tags:
  - 'WebExtensions :: General'

extensions_button:
  prefers_hidden_button:
    type: boolean
    description: >
      Records whether the user prefers the Extensions Button to be hidden.
      Corresponds to the inverse value of the
      `exceptions.unifiedExtensions.button.always_visible` pref.
    bugs:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1966935
    data_reviews:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1966935
    data_sensitivity:
      - technical
    notification_emails:
      - addons-dev-internal@mozilla.com
      - rwu@mozilla.com
    expires: 150

  toggle_visibility:
    type: event
    description: |
      When a user changes the preferred visibility of the Extensions Button,
      through the "Remove from Toolbar" or "Always Show in Toolbar" menu items.
    bugs:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1966935
    data_reviews:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1966935
    data_sensitivity:
      - interaction
    notification_emails:
      - addons-dev-internal@mozilla.com
      - rwu@mozilla.com
    expires: 150
    extra_keys:
      is_customizing:
        description: Whether the change was made in Customize Mode.
        type: boolean
      is_extensions_panel_empty:
        description: |
          Whether the Extensions Panel is unable to show any extensions.
        type: boolean
      is_temporarily_shown:
        description: |
          Whether the Extensions Button is or was temporarily shown when the
          user toggled the visibility.

          If is_temporarily_shown is true and should_hide is false, this means
          that the button stayed visible after the user tried to hide it.

          If is_temporarily_shown is true and should_hide is true, this means
          that the button was temporarily visible when the user made it
          permanently visible again.
        type: boolean
      should_hide:
        description: Whether the user wants the button to be hidden.
        type: boolean

  open_via_app_menu:
    type: event
    description: |
      When the user prefers the Extensions Button to be hidden, the default
      "Extensions and Themes" item in the Application Menu is replaced with an
      "Extensions" item, which serves as an alternative trigger for the
      Extensions Button.

      This event records when the user clicks on this "Extensions" menu item.
    bugs:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1966935
    data_reviews:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1966935
    data_sensitivity:
      - interaction
    notification_emails:
      - addons-dev-internal@mozilla.com
      - rwu@mozilla.com
    expires: 150
    extra_keys:
      is_extensions_panel_empty:
        description: |
          Whether the Extensions Panel is unable to show any extensions.

          When false, the Extensions Panel is opened.

          When true, about:addons is opened, at least until an empty state is
          added (https://bugzilla.mozilla.org/show_bug.cgi?id=1814871). When
          that bug is resolved, the Extensions Panel is always opened.
        type: boolean
      is_extensions_button_visible:
        description: |
          Whether the Extensions Button is visible. Although the appmenu item
          is only shown when the user prefers the button to be hidden, it is
          possible for the button to be shown despite the user's preference if
          there was a reason to show the button temporarily.

          If true, this could be a sign that the user is confused about the
          function of the appmenu item, because the Extensions Button offers
          exactly the same functionality, except in a more visible location
          (on the toolbar).
        type: boolean
