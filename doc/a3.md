https://bugzilla.mozilla.org/show_bug.cgi?id=1225123

## Diagnosis

The bug is a memory leak which is caused by two heap allocated variables,
`pTemplate` and `pT2`, not being freed after the function returns. The benefit of addressing the bug is to fix the memory leak so it would not result in memory related issues down the line. There is very minimal risks to fixing this bug, as it does not change any functionally, only fixing an oversight.

## Solution

The solution to this bug is to free the heap allocated variables once they are no longer needed in the execution of the function, or once the function is about to return.

## Testing

To test that the bug was resolved, I went through the function in question and ensured that any time there was a return statement, all dynamically allocated variables had been freed. I also ran the included tests and made sure they all passed.

