[https://bugzilla.mozilla.org/show_bug.cgi?id=1523864](https://bugzilla.mozilla.org/show_bug.cgi?id=1523864)

# Diagnosis

Firefox has a Web Console that web developers can use to view logs generated by the current webpage. The Web Console allows users to input keywords to filter the logs, and also provides a set of buttons to filter logs by type (Errors, Warnings, etc.). In the current version of Firefox, the filter buttons always appear on their own row, regardless of how wide the window is. This results in a lot of unused white space, both on the row with the filter input and the row with the filter buttons. This bug ticket is meant to fix this issue by displaying both elements on the same row when the display window is wide enough, reducing the amount of unused space horizontally and improving space usage vertically as well.

![mockup](https://bugzilla.mozilla.org/attachment.cgi?id=9042395)

The [mockup](https://bugzilla.mozilla.org/attachment.cgi?id=9042395) above (from the Buzilla entry) suggests that after these changes the filter buttons should appear between the filter input and a checkbox that allows users to persist logs while visiting different webpages. The risk of this change is minimal, but it does require some planning to make sure that the UI is still easy to use and the fix should not impact performance when rendering the Web Console.


# Proposed Solution

The proposed solution in the Bugzilla bug entry suggested using CSS Grid and media queries to detect when the window reaches a specific threshold and modify where in the grid the filter buttons are displayed. The problem with this is that the filter bar is structured with nested div elements. A simplified example is shown below:

```HTML
<div class="container">
    <div class="primary">
        <input class="filter-input">
        <input class="persis-logs">
    </div>
    <div class="secondary"> ... buttons ... </div>
</div>
```

The goal is to stick the `.secondary` div between the `.filter-input` and `.persis-logs` input elements when the window is large enough. In order to use CSS Grid, the `.container` div needs a grid template to organize its children div elements. The issue with this solution is that the template only applies to immidiate children elements. It is impossible to to move an element to be a child of one of its sibling elements. Furthermore, adding a grid template to the `.primary` div will only apply to that divs children, and not to its siblings. Another option is to eliminate the `.primary` div and add a grid template to the `.container` div, but this results in some other serious style issues and is not a feasible solution either.

A different approach is to implement a solution in the React FilterBar componenet. This solution requires adding an event lister to the component to detect when the browser window is resized. When this event fires, if the `.primary` div has enough empty space to include the minimum width size of the `.secondary` div, then the `.secondary` div can be rendered directly between the input elements. A boolean state variable needs to be added indicate where the buttons should be rendered. Then in the render function, this state variable can be checked to conditionally render the `.secondary` div in the correct location.

There are two issues with the React solution. The first is that the FilterBar componenet is a dumb component, meaning it currently does not manage its own state and makes changes based on props passed from its parent component. It is ideal to keep components dumb when possible to make it easier to reason about state. The second is that a React solution is likely to add a performance overhead because the componeent will need to be rerendered when the window size changes.

Ultimately, since the CSS solution is not possible, the React solution may be the only option. These options have been discussed with this bug's Mozilla mentor, who agrees that the CSS solution is not actually feasible and that a React solution may be necessary.

This bug is still worth fixing beacuse it eliminates unecessary whitespace and condenses the Web Console filter bar, allowing more space for console messages.

# Testing

Inital testing will be performed with manual inspection.

Before the fix, the filter buttons will always appear below the filter input, as seen below:

After the fix, when the window is wide and there is enough space the filter buttons will be displayed inline with the filter input, as such:

Gradually decrease the window's width and once the filter input reaches a minimum size of 150 px, the filter buttons will be rendered below the filter input instead, as such:

This change also requires frontend testing. Two tests will be added. The first will test that when the window is large enough, the width of the filter input is at least 150px, and the `.secondary` div is a child of the `.primary` div and appears between the two inputs. The second will test that when the window is small, the width of the filter input is still at least 150 px and the `.secondary` div is a sibling of the `.secondary` div.
